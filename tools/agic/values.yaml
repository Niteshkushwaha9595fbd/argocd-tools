# Complete values.yaml for AGIC configured to use a User Assigned Managed Identity (aad-pod-identity)
# Replace the placeholder values below:
#   - <UAMI_RESOURCE_ID> : full resource id of your user assigned managed identity
#   - <UAMI_CLIENT_ID>   : clientId of the UAMI (you provided 4af1a466-2fe5-4505-8bc1-23971ea7ae2f)
#   - <VNET_RESOURCE_ID> : resource id of the VNet (for role assignment)
#   - <APPGW_RESOURCE_ID> : resource id of the Application Gateway (already set below)
#
verbosityLevel: 3

image:
  repository: mcr.microsoft.com/azure-application-gateway/kubernetes-ingress
  tag: 1.9.4
  pullPolicy: Always

kubernetes:
  watchNamespace: ""
  httpServicePort: 8123
  multiClusterMode: false
  nodeSelector: {}
  tolerations: []
  affinity: {}
  securityContext:
    runAsUser: 0
  containerSecurityContext: {}
  podAnnotations: {}
  resources: {}
  volumes: {}
  ingressClassResource:
    name: azure-application-gateway
    enabled: true
    default: false
    controllerValue: "azure/application-gateway"

# Application Gateway configuration
appgw:
  applicationGatewayID: "/subscriptions/1c31cbbc-25c4-40cf-8e4e-44be901aa7ef/resourceGroups/pardeep-rg-0607/providers/Microsoft.Network/applicationGateways/applicationgateway"
  subscriptionId: "1c31cbbc-25c4-40cf-8e4e-44be901aa7ef"
  resourceGroup: "pardeep-rg-0607"
  name: "applicationgateway"

# Authentication with Azure Resource Manager - using aad-pod-identity (UAMI)
armAuth:
  type: aadPodIdentity
  # Set identityResourceID to the full resource id of your User Assigned Managed Identity
  identityResourceID: "/subscriptions/1c31cbbc-25c4-40cf-8e4e-44be901aa7ef/resourceGroups/pardeep-rg-0607/providers/Microsoft.ManagedIdentity/userAssignedIdentities/Pradeep-agic-role"
  # Optional but useful: clientId of the UAMI
  identityClientID: "4af1a466-2fe5-4505-8bc1-23971ea7ae2f"

# Node scheduling (legacy duplicate kept for compatibility)
nodeSelector: {}

# RBAC - set true if your cluster enforces RBAC
rbac:
  enabled: true

podSecurityContext: {}
containerSecurityContext: {}
podAnnotations: {}
resources: {}
volumes: {}

metrics:
  enabled: false
  serviceMonitor:
    enabled: false

tolerations: []
affinity: {}

extraArgs: {}

# -------------------------
# ServiceAccount configuration for aad-pod-identity
# -------------------------
# For aad-pod-identity, the ServiceAccount must be annotated with aadpodidentitybinding: "<selector>"
# The selector must match the AzureIdentityBinding.selector you create in the cluster.
serviceAccount:
  create: true
  name: agicserviceaccount
  annotations:
    # This selector name must match the AzureIdentityBinding.selector (example below: agic-uami-selector)
    aadpodidentitybinding: "agic-uami-selector"

service:
  type: ClusterIP
  port: 8123

imagePullSecrets: []

# Optional: additional notes for role assignment (replace placeholders)
# APPGW_RESOURCE_ID is already set above in appgw.applicationGatewayID
# VNET_RESOURCE_ID should be used when assigning Network Contributor to the UAMI:
#   az role assignment create --assignee <UAMI_PRINCIPAL_ID> --role "Network Contributor" --scope <VNET_RESOURCE_ID>
#   az role assignment create --assignee <UAMI_PRINCIPAL_ID> --role "Contributor" --scope /subscriptions/1c31cbbc-25c4-40cf-8e4e-44be901aa7ef/resourceGroups/pardeep-rg-0607/providers/Microsoft.Network/applicationGateways/applicationgateway

# End of values.yaml
