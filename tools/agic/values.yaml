# Complete values.yaml for AGIC (merge of your provided values + required appgw and auth)
# Replace <UAMI_CLIENT_ID_OR_AAD_APP_CLIENT_ID> with your actual identity client id (for workload identity)
# If you prefer using applicationGatewayID instead of subscription/resource/name, the applicationGatewayID field is already set.

verbosityLevel: 3

image:
  repository: mcr.microsoft.com/azure-application-gateway/kubernetes-ingress
  tag: 1.9.4
  pullPolicy: Always

kubernetes:
  # Leave empty to watch all namespaces
  watchNamespace: ""
  httpServicePort: 8123
  multiClusterMode: false
  nodeSelector: {}
  tolerations: []
  affinity: {}
  securityContext:
    runAsUser: 0
  containerSecurityContext: {}
  podAnnotations: {}
  resources: {}
  volumes: {}
  ingressClassResource:
    name: azure-application-gateway
    enabled: true
    default: false
    controllerValue: "azure/application-gateway"

# Application Gateway configuration
appgw:
  # Preferred: full resource id (uncomment to use)
  applicationGatewayID: "/subscriptions/1c31cbbc-25c4-40cf-8e4e-44be901aa7ef/resourceGroups/pardeep-rg-0607/providers/Microsoft.Network/applicationGateways/applicationgateway"

  # Alternative fields (kept for reference; not required if applicationGatewayID is set)
  subscriptionId: "1c31cbbc-25c4-40cf-8e4e-44be901aa7ef"
  resourceGroup: "pardeep-rg-0607"
  name: "applicationgateway"
  # usePrivateIP: false
  # subResourceNamePrefix: "myPrefix"
  # If you want AGIC to create a new AppGw, set name + subnetPrefix (and ensure identity has VNet permissions)
  # subnetPrefix: "10.1.0.0/16"

# Authentication with Azure Resource Manager
# Choose one of the armAuth types below. Workload Identity is recommended for AKS.
armAuth:
  type: workloadIdentity
  identityClientID: "<UAMI_CLIENT_ID_OR_AAD_APP_CLIENT_ID>"

# Legacy options (commented) if you use aad-pod-identity or service principal
# armAuth:
#   type: aadPodIdentity
#   identityResourceID: "/subscriptions/<sub>/resourceGroups/<rg>/providers/Microsoft.ManagedIdentity/userAssignedIdentities/<identity-name>"
#   identityClientID: "<client-id>"
#
# armAuth:
#   type: servicePrincipal
#   existingSecret: mysecret
#   secretJSON: <base64-encoded-JSON-blob>

# Node scheduling (legacy duplicate kept for compatibility)
nodeSelector: {}

# RBAC - set true if your cluster enforces RBAC
rbac:
  enabled: true

# Pod security / resources / extra mounts (customize as needed)
podSecurityContext: {}
containerSecurityContext: {}
podAnnotations: {}
resources: {}
volumes: {}

# Optional: set ingressClass override
# ingressClass: agic-2

# Optional: additional settings
# reconcilePeriodSeconds: 30

# Optional: enable metrics / prometheus scraping (example)
metrics:
  enabled: false
  serviceMonitor:
    enabled: false

# Optional: tolerations/affinity for scheduling
tolerations: []
affinity: {}

# Optional: extra args to AGIC container
extraArgs: {}

# Optional: service account name (if you created a specific SA)
serviceAccount:
  create: false
  name: agic-serviceaccount

# Optional: nodePort / service type overrides
service:
  type: ClusterIP
  port: 8123

# Optional: imagePullSecrets
imagePullSecrets: []

# Notes:
# 1) Replace <UAMI_CLIENT_ID_OR_AAD_APP_CLIENT_ID> with the actual client id you will use for workload identity.
# 2) Ensure the identity (principalId) has required Azure roles:
#    - Contributor on Application Gateway (or RG) if AGIC must modify AppGw
#    - Network Contributor on the VNet (or scope containing the subnet) to allow subnet join
#    - Reader on resource group(s) as needed
# 3) If you prefer not to use applicationGatewayID, you can remove that field and rely on subscriptionId/resourceGroup/name.
# 4) After updating values.yaml, validate with:
#    helm template . --name-template agic --namespace kube-system --kube-version 1.33 -f values.yaml --include-crds
# 5) Then install/upgrade:
#    helm upgrade --install agic application-gateway-ingress-controller/ingress-azure --namespace kube-system -f values.yaml
